---
title: "GA6_R"
author: "Freddy Mendez"
date: today
format:
  html: 
   theme: cosmo
toc: true
self-contained: true
---

## **Main assignment:**

### R Basics

#1. Create a character vector fav_food with five names of your favorite food. Replace third element of the vector with a bird name and extract first and fifth element.

```{r}
fav_food <- c("Burger", "arepa", "tacos", "shawarma", "Tamal_huilense")
fav_food[3] <- "Humming-bird"
fav_food[c(1,5)]
```

#2. Load the tidyverse package. We have seen in the class that when we load the tidyverse package, we see many warnings. Use the code chunk option to hide the warning. Read your metadata.tsv file from the garrigos-data/meta directory and save it as object metadata. Write down the data structure of the metadata, number of variables, and rows.

```{r}
#| echo: false
library(tidyverse)
metadata <- read_tsv(file = "/fs/ess/PAS2880/users/garrigos-data/meta/metadata.tsv")
metadata
# Number of variables: 3 variables
# number of rows: 22 rows
```

#3. In the metadata object, replace the dpi with \_dpi of the time variable and cathemerium with cath of the treatment variable.

```{r}
metadata |>
  mutate(
    time = sub(pattern = "dpi", replacement = "_dpi", x = time)
  )
```

```{r}
metadata |>
  mutate(
    treatment = sub(pattern = "cathemerium", replacement = "cath", x = treatment)
  )
```

### Data wrangling

#1. List all the datasets available in the ggplot2 package. Read the data from inbuilt- dataset midwest. Save it as an object midwest_datasets and use the midwest_datasets to answer all the question afterwards.

```{r}
data(package = "ggplot2")
data("midwest")
view(midwest)
midwest_datasets <- ggplot2::midwest
```

#using the pipe for questions 2, 3 and 4

```{r}
new_dataset <- midwest_datasets |>
  filter(poptotal > 30000, popdensity > 800)|>
  select(1:11) |>
  mutate(asian_ameri = popasian / popamerindian) |>
  arrange(desc(asian_ameri)) |>
  group_by(state) |>
  summarise(poptotal = mean(poptotal, na.rm = TRUE))

```

#2. Filter the rows with poptotal \> 30000 and popdensity \> 800.

```         
midwest_datasets |>
  filter(poptotal > 30000, popdensity > 800)
```

#3. Select first 11 variables of the dataset. Create a new column named asian_ameri in midwest_datasets object by dividing popasian by popamerindian and sort asian_ameri in descending order. Save this output as new_dataset object

```         
midwest_datasets |>
  select(1:11)

new_dataset <- midwest_datasets |>
  mutate(asian_ameri = popasian / popamerindian) |>
  arrange(desc(asian_ameri))
```

#4. Compute the total mean population per state and name the mean column as poptotal.

```         
new_datasets |>
  group_by(state) |>
  summarise(poptotal = mean(poptotal, na.rm = TRUE))
```

### Quarto and Data Visualization

# 1. Create the violin plot with state in x-axis and area in y-axis. Facet the plot based on the category.

```{r}
midwest_datasets |> 
ggplot(aes(x = state, y = area)) +
  geom_violin() +
  facet_wrap(vars(category))

```

#2. Create a violin plot again with state in x-axis and poptotal in y-axis. Add the jitter points on the plot and color just the points based on the category. Is this point color global or local mapping? please explain.

```{r}
midwest_datasets |> 
ggplot(aes(x = state, y = poptotal)) +
  geom_violin() +
  geom_jitter(aes(color = category))


```
# This point color is local mapping, since color = category is inside the geom_jitter() function and not by the ggplot()function (if this where the case the mapping will be global).


#3. In the above plot change the theme to theme_bw and color the state manually instead of using default colors. Add the title of the plot using the code chunk options. Save this plot as an object violin_plot.

```{r}
violin_plot <- midwest_datasets |> 
ggplot(aes(x = state, y = poptotal)) +
  geom_violin() +
  geom_jitter(aes(color = state)) +
    scale_color_manual(values = c("blue","green","purple","red","orange")) +
    labs(title = "Violin plot of population by state") +
            theme_bw()

violin_plot
         
```

